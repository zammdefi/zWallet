<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Base USDC IOU Test</title>
    <style>
        body {
            font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, sans-serif;
            max-width: 800px;
            margin: 40px auto;
            padding: 20px;
            background: #f5f5f5;
        }
        .test-section {
            background: white;
            border-radius: 8px;
            padding: 20px;
            margin-bottom: 20px;
            box-shadow: 0 1px 3px rgba(0,0,0,0.1);
        }
        h2 {
            margin-top: 0;
            color: #333;
        }
        .info {
            background: #e8f4ff;
            padding: 12px;
            border-radius: 4px;
            margin: 10px 0;
            font-size: 14px;
        }
        .success {
            background: #d4edda;
            color: #155724;
        }
        .error {
            background: #f8d7da;
            color: #721c24;
        }
        code {
            background: #f4f4f4;
            padding: 2px 6px;
            border-radius: 3px;
            font-family: monospace;
        }
        pre {
            background: #f4f4f4;
            padding: 15px;
            border-radius: 4px;
            overflow-x: auto;
        }
    </style>
</head>
<body>
    <h1>Base USDC IOU Implementation Test</h1>
    
    <div class="test-section">
        <h2>‚úÖ Base USDC Constants</h2>
        <div class="info">
            <strong>Contract Address:</strong> <code>0x833589fCD6eDb6E08f4c7C32D4f71b54bdA02913</code><br>
            <strong>Chain ID:</strong> <code>8453</code><br>
            <strong>Transfer Auth TypeHash:</strong> <code>0x7c7c6cdb67a18743f49ec6fa9b35f50d52ed05cbed4cc592e13b44501c1a2267</code><br>
            <strong>Domain Separator:</strong> <code>0x02fa7265e7c5d81118673727957699e4d68f74cd74b7db77da710fe8a2c7834f</code>
        </div>
    </div>

    <div class="test-section">
        <h2>‚úÖ EIP-712 Domain Structure</h2>
        <pre>{
  name: "USD Coin",
  version: "2",
  chainId: 8453,
  verifyingContract: "0x833589fCD6eDb6E08f4c7C32D4f71b54bdA02913"
}</pre>
    </div>

    <div class="test-section">
        <h2>‚úÖ Transfer Authorization Type</h2>
        <pre>TransferWithAuthorization: [
  { name: "from", type: "address" },
  { name: "to", type: "address" },
  { name: "value", type: "uint256" },
  { name: "validAfter", type: "uint256" },
  { name: "validBefore", type: "uint256" },
  { name: "nonce", type: "bytes32" }
]</pre>
    </div>

    <div class="test-section">
        <h2>‚úÖ IOU Slip Format</h2>
        <p>The IOU slip will include:</p>
        <ul>
            <li>Network identifier: <code>chainId: 8453</code> for Base</li>
            <li>Network name: <code>network: "Base"</code></li>
            <li>Filename format: <code>usdc-iou-base-[timestamp].json</code></li>
            <li>Amount display: <code>[amount] USDC (Base)</code></li>
        </ul>
    </div>

    <div class="test-section">
        <h2>‚úÖ UI Updates</h2>
        <div class="info success">
            <strong>Send Tab:</strong> Shows all Base tokens (ETH, USDC, USDT, DAI)<br>
            <strong>IOU Mode:</strong> Available when USDC is selected on Base<br>
            <strong>Token Fetching:</strong> Uses backend contract's batchView (same as mainnet)<br>
            <strong>Network Detection:</strong> Correctly uses Base domain when on Base network
        </div>
    </div>

    <div class="test-section">
        <h2>üìã Implementation Summary</h2>
        <p>The Base USDC IOU functionality has been successfully implemented with:</p>
        <ol>
            <li>‚úÖ Added Base USDC EIP-712 domain constants</li>
            <li>‚úÖ Network-aware domain selection in signature generation</li>
            <li>‚úÖ Updated UI to show all Base tokens in send tab</li>
            <li>‚úÖ IOU slips include network information (chainId and network name)</li>
            <li>‚úÖ File naming includes network prefix</li>
            <li>‚úÖ Display shows network in IOU amount</li>
            <li>‚úÖ Uses backend contract for token fetching (mirrors mainnet)</li>
        </ol>
    </div>

    <div class="test-section">
        <h2>üîç How to Test</h2>
        <ol>
            <li>Switch to Base network in the extension</li>
            <li>Select USDC from the token dropdown in Send tab</li>
            <li>Toggle IOU mode ON</li>
            <li>Enter recipient address and amount</li>
            <li>Create IOU slip</li>
            <li>Verify the downloaded JSON file contains:
                <ul>
                    <li><code>chainId: 8453</code></li>
                    <li><code>network: "Base"</code></li>
                    <li>Correct signature using Base USDC domain</li>
                </ul>
            </li>
        </ol>
    </div>

    <script>
        // Test data for verification
        const BASE_USDC_CONSTANTS = {
            address: "0x833589fCD6eDb6E08f4c7C32D4f71b54bdA02913",
            chainId: 8453,
            transferAuthTypehash: "0x7c7c6cdb67a18743f49ec6fa9b35f50d52ed05cbed4cc592e13b44501c1a2267",
            domainSeparator: "0x02fa7265e7c5d81118673727957699e4d68f74cd74b7db77da710fe8a2c7834f"
        };
        
        console.log("Base USDC IOU Test Page Loaded");
        console.log("Constants:", BASE_USDC_CONSTANTS);
    </script>
</body>
</html>